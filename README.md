# NEXA - פורטל חישוב דירוג אנרגטי

מערכת לניהול הזמנות לחישוב דירוג אנרגטי לבניינים עפ"י תקן ת"י 5282.

## תכונות

✅ **דף נחיתה בעברית** - ממשק משתמש מודרני ונוח
✅ **מערכת אימות משתמשים** - הרשמה והתחברות מאובטחת
✅ **טופס הזמנה מקיף** - 37 שדות לפי מבנה הדרישות של ת"י 5282
✅ **ניהול הזמנות** - כל משתמש רואה רק את ההזמנות שלו
✅ **שכפול הזמנות** - אפשרות לשכפל הזמנה קיימת
✅ **אינטגרציה עם Google Sheets** - שליחה אוטומטית של הזמנות לצוות המודלים
✅ **אחסון מקומי** - כל הנתונים נשמרים בקבצי JSON

## מבנה הפרויקט

```
energy-rating-portal/
├── public/                 # קבצי Frontend
│   ├── index.html         # דף הנחיתה הראשי
│   ├── css/
│   │   └── style.css      # עיצוב האתר
│   └── js/
│       └── app.js         # לוגיקת Frontend
├── server/                # Backend Server
│   ├── server.js          # שרת Express
│   └── google-credentials.json  # אישורי Google API (לא כלול)
├── data/                  # אחסון נתונים
│   ├── users.json         # רשימת משתמשים
│   └── orders.json        # רשימת הזמנות
└── package.json           # הגדרות הפרויקט
```

## התקנה והפעלה

### דרישות מקדימות

- Node.js (גרסה 14 או חדשה יותר)
- npm (מותקן עם Node.js)

### שלבי התקנה

1. **התקנת תלויות** (כבר בוצעה):
```bash
npm install
```

2. **הפעלת השרת**:
```bash
npm start
```

השרת יעלה על: http://localhost:3000

3. **פתיחת הדפדפן**:
פתח את הכתובת: http://localhost:3000

## שימוש במערכת

### עבור משתמשים

1. **הרשמה למערכת**:
   - לחץ על כפתור "הרשמה"
   - מלא פרטים: שם מלא, אימייל וסיסמה
   - לחץ "הרשמה"

2. **התחברות**:
   - לחץ על כפתור "כניסה"
   - הזן אימייל וסיסמה
   - לחץ "כניסה"

3. **הזמנת חישוב**:
   - לחץ על "הזמן חישוב עכשיו"
   - מלא את כל השדות הנדרשים (מסומנים בכוכבית *)
   - לחץ "שלח הזמנה"

4. **צפייה בהזמנות**:
   - לחץ על "ההזמנות שלי"
   - צפה בכל ההזמנות שביצעת
   - לחץ "שכפל הזמנה" כדי לשכפל הזמנה קיימת

### שכפול הזמנה

- כאשר אתה לוחץ על "שכפל הזמנה", הטופס יפתח עם כל הנתונים מההזמנה המקורית
- תוכל לערוך את הנתונים לפני שליחת ההזמנה החדשה
- זה חוסך זמן כאשר יש לך פרויקטים דומים

## אינטגרציה עם Google Sheets

### הגדרת חשבון Google Cloud

1. **יצירת פרויקט ב-Google Cloud Console**:
   - גש ל-https://console.cloud.google.com/
   - צור פרויקט חדש
   - הפעל את Google Sheets API

2. **יצירת Service Account**:
   - עבור ל-"IAM & Admin" > "Service Accounts"
   - צור Service Account חדש
   - הורד את קובץ ה-JSON של האישורים

3. **הוספת קובץ האישורים**:
   - שמור את הקובץ בשם `google-credentials.json`
   - העתק אותו לתיקייה `server/`

4. **הגדרת ה-Spreadsheet ID**:
   - פתח את קובץ `server/server.js`
   - מצא את השורה:
   ```javascript
   const SPREADSHEET_ID = 'YOUR_SPREADSHEET_ID_HERE';
   ```
   - החלף את `YOUR_SPREADSHEET_ID_HERE` ב-ID של ה-Google Sheet שלך
   - ה-ID נמצא ב-URL של הגיליון: `https://docs.google.com/spreadsheets/d/[SPREADSHEET_ID]/edit`

5. **שיתוף הגיליון**:
   - שתף את ה-Google Sheet עם כתובת המייל של ה-Service Account
   - תן הרשאות עריכה

### מבנה הנתונים ב-Google Sheets

כל הזמנה נשלחת כשורה חדשה עם העמודות הבאות:

| עמודה | תוכן |
|-------|------|
| A | תאריך יצירת ההזמנה |
| B | שם המשתמש |
| C | אימייל המשתמש |
| D | סטטוס ההזמנה |
| E-AO | כל 37 השדות מהטופס |

## אבטחה ופרטיות

### הגנת נתונים

- **הפרדת משתמשים**: כל משתמש רואה רק את ההזמנות שלו
- **אחסון מקומי**: כל הנתונים נשמרים בשרת המקומי
- **אימות פשוט**: מערכת התחברות בסיסית (מומלץ לשדרג ל-bcrypt בסביבת ייצור)

### המלצות לסביבת ייצור

אם אתה מעלה את המערכת לסביבת ייצור, מומלץ:

1. **הצפנת סיסמאות**: השתמש ב-bcrypt לשמירת סיסמאות:
```javascript
const bcrypt = require('bcrypt');
const hashedPassword = await bcrypt.hash(password, 10);
```

2. **JWT Tokens**: השתמש ב-JWT לניהול הזדהות:
```javascript
const jwt = require('jsonwebtoken');
const token = jwt.sign({ userId: user.id }, 'secret_key');
```

3. **HTTPS**: הפעל את השרת עם SSL/TLS
4. **סביבת משתנים**: השתמש ב-`.env` לאחסון מפתחות API
5. **מסד נתונים**: העבר לשימוש ב-MongoDB או PostgreSQL במקום JSON

## פתרון בעיות

### השרת לא עולה

- ודא ש-Node.js מותקן: `node --version`
- ודא שהפורט 3000 פנוי
- בדוק שכל התלויות מותקנות: `npm install`

### לא מצליח להתחבר

- בדוק את קובץ `data/users.json` - האם המשתמש קיים?
- נקה את ה-localStorage בדפדפן ונסה שוב
- בדוק את ה-Console בדפדפן לשגיאות

### Google Sheets לא עובד

- ודא שקובץ `google-credentials.json` קיים בתיקיית `server/`
- ודא ש-SPREADSHEET_ID מוגדר נכון ב-`server/server.js`
- ודא שה-Service Account משותף על הגיליון
- בדוק את הלוגים של השרת לשגיאות

## טכנולוגיות

### Frontend
- HTML5
- CSS3 (Grid, Flexbox, Custom Properties)
- Vanilla JavaScript (ES6+)

### Backend
- Node.js
- Express.js
- Google Sheets API v4

### אחסון
- File System (JSON files)

## תמיכה והמשך פיתוח

### רעיונות לשיפורים עתידיים

- [ ] העלאת קבצים (תוכניות, דוחות תרמיים)
- [ ] מערכת התראות במייל
- [ ] פאנל ניהול לצוות המודלים
- [ ] דשבורד עם סטטיסטיקות
- [ ] ייצוא הזמנות ל-PDF
- [ ] אינטגרציה עם מערכות תשלום
- [ ] מערכת תגובות והערות
- [ ] תמיכה בקבצים מצורפים

## רישיון

ISC License - Copyright (c) 2025 NEXA

---

**נבנה עבור NEXA - יעוץ אנרגטי מתקדם**
